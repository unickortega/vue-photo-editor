var VuePhotoEditor=function(i){"use strict";function e(i){e.installed||(e.installed=!0,i.component("VuePhotoEditor",t))}!function(){if("undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],e=document.createElement("style"),t=".editor-container[data-v-e5c7b356] { -webkit-touch-callout: none; user-select: none; position: relative; height: 300px; overflow: hidden; background: black; } .editor-container .back-drop[data-v-e5c7b356] { height: 100%; width: 100%; opacity: 0.5; z-index: 10; position: absolute; background: black; } .editor-container .backdrop-image[data-v-e5c7b356] { position: absolute; z-index: 9; -webkit-touch-callout: none; user-select: none; } .editor-container .front-image-container[data-v-e5c7b356] { margin: auto; position: absolute; top: 50%; left: 50%; transform: translateX(-50%) translateY(-50%); overflow: hidden; height: 250px; width: 250px; z-index: 11; } .editor-container .front-image-container .frame[data-v-e5c7b356] { border: 3px solid white; position: absolute; width: 100%; height: 100%; top: 0px; left: 0px; } .editor-container .front-image-container .frame .lines .h-line[data-v-e5c7b356] { height: 2px; width: 100%; background: white; position: absolute; } .editor-container .front-image-container .frame .lines .v-line[data-v-e5c7b356] { height: 100%; width: 2px; background: white; position: absolute; } .editor-container .front-image-container .image[data-v-e5c7b356] { position: absolute; } .photo-options[data-v-e5c7b356] { padding: 0px 15px; } .file-input[data-v-e5c7b356] { display: none; } .loading[data-v-e5c7b356] { position: fixed; top: 0px; left: 0px; width: 100%; height: 100%; } .loading .background[data-v-e5c7b356] { background: black; opacity: 0.75; position: absolute; left: 0px; top: 0px; width: 100%; height: 100%; } .loading .loading-icon[data-v-e5c7b356] { position: absolute; top: 50%; left: 50%; transform: translateX(-50%) translateY(-50%); width: 60px; } ";e.type="text/css",e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t)),i.appendChild(e)}}();var t={render:function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",[t("div",{ref:"modal",staticClass:"modal fade",attrs:{tabindex:"-1",role:"dialog"}},[t("div",{staticClass:"modal-dialog modal-dialog-centered modal-lg"},[t("div",{staticClass:"modal-content"},[t("div",{staticClass:"modal-header"},[t("h5",{staticClass:"modal-title"},[i._v(i._s(i.title))]),i._v(" "),i._m(0)]),i._v(" "),t("div",{staticClass:"modal-body",staticStyle:{padding:"0px"}},[t("div",{ref:"editor-container",staticClass:"editor-container"},[t("img",{ref:"backdrop-image",staticClass:"backdrop-image",attrs:{src:i.image_source}}),i._v(" "),t("div",{ref:"backdrop",staticClass:"back-drop"}),i._v(" "),t("div",{ref:"result-image-container",staticClass:"front-image-container"},[t("img",{ref:"result-image",staticClass:"image",attrs:{draggable:"false",src:i.image_source}}),i._v(" "),i._m(1)])]),i._v(" "),t("div",{staticClass:"photo-options"},[t("div",{staticClass:"form-group"},[t("label",{attrs:{for:"customRange3"}},[i._v("Zoom Picture")]),i._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:i.zoom,expression:"zoom"}],ref:"zoom-range",staticClass:"custom-range",attrs:{type:"range",step:"5",value:"0",min:"0",max:"300",id:"customRange3"},domProps:{value:i.zoom},on:{__r:function(e){i.zoom=e.target.value}}})]),i._v(" "),t("div",{staticClass:"form-group text-center"},[t("input",{ref:"file-input",staticClass:"file-input",attrs:{type:"file",id:"inputGroupFile01",accept:"image/x-png,image/jpeg"}}),i._v(" "),t("button",{staticClass:"btn btn-default",attrs:{type:"button"},on:{click:i.triggerFileInput}},[i._v("Change Photo")])])])]),i._v(" "),t("div",{staticClass:"modal-footer"},[t("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[i._v("Close")]),i._v(" "),t("button",{staticClass:"btn btn-success",attrs:{type:"button","data-dismiss":"modal"},on:{click:i.saveImage}},[i._v("Save")])])])])]),i._v(" "),t("div",{directives:[{name:"show",rawName:"v-show",value:i.busy,expression:"busy"}],staticClass:"loading"},[t("div",{staticClass:"background"}),i._v(" "),t("img",{staticClass:"loading-icon",attrs:{src:i.public_path+"/images/loading.gif",alt:""}})])])},staticRenderFns:[function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[t("span",{attrs:{"aria-hidden":"true"}},[i._v("Ã—")])])},function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"frame"},[t("div",{staticClass:"lines"},[t("div",{staticClass:"v-line",staticStyle:{left:"33.3333%"}}),i._v(" "),t("div",{staticClass:"v-line",staticStyle:{left:"66.6666%"}}),i._v(" "),t("div",{staticClass:"h-line",staticStyle:{top:"33.3333%"}}),i._v(" "),t("div",{staticClass:"h-line",staticStyle:{top:"66.6666%"}})])])}],_scopeId:"data-v-e5c7b356",name:"vue-photo-editor",props:{resultImageDimension:{type:Object,default:function(){return{height:250,width:250}}},title:{type:String,default:"Photo"}},data:function(){return{editorDimension:{height:250,width:250},public_path:location.origin,images:[],zoom:0,position:{top:0,left:0},resolution:.8,image_source:location.origin+"/images/photo.png",busy:!1,image_source_dimensions:{},preffered_diameter:250}},methods:{show:function(i){this.position={top:0,left:0},this.zoom=0,this.image_source=i,jQuery(this.$refs.modal).modal("show")},triggerFileInput:function(){this.$refs["file-input"].click()},loading:function(i){this.busy=i},setInitDimension:function(){jQuery(this.$refs["result-image"]);console.log(this.image_source_dimensions.width+"--"+this.editorDimension.width),this.image_source_dimensions.width>this.image_source_dimensions.height?this.image_source_dimensions.width<=this.editorDimension.width?this.setImageDimention("100%","initial"):this.setImageDimention("initial","100%"):this.image_source_dimensions.height<=this.editorDimension.height?this.setImageDimention("initial","100%"):this.setImageDimention("100%","initial")},setInitialPosition:function(){var i=this.$refs["result-image-container"],e=jQuery(i).width()/2-this.image_source_dimensions.width/2,t=jQuery(i).height()/2-this.image_source_dimensions.height/2;this.setImageResultPosition(e,t,!0)},calculateImageSourceDimensions:function(){var i=new Image,e=this;i.onload=function(){i.width>i.height?e.editorDimension.height/i.height*i.width<e.editorDimension.width?(e.image_source_dimensions.width=e.editorDimension.width,e.image_source_dimensions.height=e.image_source_dimensions.width/i.width*i.height):(e.image_source_dimensions.height=e.editorDimension.height,e.image_source_dimensions.width=e.image_source_dimensions.height/i.height*i.width):e.editorDimension.width/i.width*i.height<e.editorDimension.height?(e.image_source_dimensions.height=e.editorDimension.height,e.image_source_dimensions.width=e.image_source_dimensions.height/i.height*i.width):(e.image_source_dimensions.width=e.editorDimension.width,e.image_source_dimensions.height=e.image_source_dimensions.width/i.width*i.height),e.zoom=0,e.position={top:0,left:0},e.setInitDimension(),e.setInitialPosition()},i.src=this.image_source},setImageDimention:function(i,e){var t=jQuery(this.$refs["result-image"]),s=jQuery(this.$refs["backdrop-image"]);t.css({width:i,height:e}),s.css({width:t.width(),height:t.height()})},setImageResultPosition:function(i,e,t){var s=jQuery(this.$refs["result-image"]),o=jQuery(this.$refs["result-image-container"]),n=s.position().left,a=s.position().top,r=this.zoom/100,h=this.image_source_dimensions.width+this.image_source_dimensions.width*r,d=this.image_source_dimensions.height+this.image_source_dimensions.height*r;i<=0&&i+h>=jQuery(o).width()||t?n=i:i+h<jQuery(o).width()&&(n=-(h-o.width())),e<=0&&e+d>=jQuery(o).height()||t?a=e:e+d<jQuery(o).height()&&(a=-(d-o.height())),this.position={top:a,left:n},jQuery(s).css({left:n,top:a}),this.setImageBackdropPosition()},setImageBackdropPosition:function(){var i=this.$refs["backdrop-image"],e=this.$refs.backdrop,t=this.$refs["result-image"],s=this.$refs["result-image-container"],o=jQuery(t).width()/2+jQuery(t).position().left,n=jQuery(t).height()/2+jQuery(t).position().top,a=o-jQuery(s).width()/2,r=n-jQuery(s).height()/2,h=jQuery(e).width()/2-jQuery(i).width()/2+a,d=jQuery(e).height()/2-jQuery(i).height()/2+r;jQuery(i).css({left:h,top:d})},zoomImage:function(i){jQuery(this.$refs["result-image"]);this.zoom=i;var e=i/100,t=this.image_source_dimensions.width+this.image_source_dimensions.width*e,s=this.image_source_dimensions.height+this.image_source_dimensions.height*e,o=this.returnCenter();this.image_source_dimensions.width>this.image_source_dimensions.height?this.editorDimension.height/this.image_source_dimensions.height*this.image_source_dimensions.width<this.editorDimension.width?this.setImageDimention(t,"initial"):this.setImageDimention("initial",s):this.editorDimension.width/this.image_source_dimensions.width*this.image_source_dimensions.height<this.editorDimension.height?this.setImageDimention("initial",s):this.setImageDimention(t,"initial");var n=o.left-t/2,a=o.top-s/2;n=parseInt(n+t)<=parseInt(this.editorDimension.width)?-(t-this.editorDimension.width):parseInt(t+n)>=parseInt(this.editorDimension.width)?n:0,a=parseInt(a+s)<=parseInt(this.editorDimension.height)?parseInt(-(s-this.editorDimension.height)):parseInt(s+a)>=parseInt(this.editorDimension.height)?a:0,this.setImageResultPosition(n,a)},returnCenter:function(){var i=jQuery(this.$refs["result-image"]);return{left:jQuery(i).width()/2+jQuery(i).position().left,top:jQuery(i).height()/2+jQuery(i).position().top}},saveImage:function(){jQuery(this.$refs["result-image"]);var i=document.createElement("canvas"),e=i.getContext("2d"),t=new Image,s=this;t.onload=function(){i.height=s.resultImageDimension.height,i.width=s.resultImageDimension.width;var o=t.width,n=t.height,a=o>n?n:o,r=s.zoom/100,h=a*(a/(r*a+a)),d=s.resolution,m=document.createElement("canvas"),c=m.getContext("2d");h*d>i.width?(m.width=t.width*d,m.height=t.height*d):(m.width=t.width,m.height=t.height),c.drawImage(t,0,0,m.width,m.height),a=m.width>m.height?m.height:m.width;var u=m.width,l=m.height;if(a/2>i.width){u=m.width*d,l=m.height*d;var g=document.createElement("canvas"),p=g.getContext("2d");g.width=u,g.height=l,p.drawImage(m,0,0,u,l),m=g}a=u>l?l:u;var f=s.editorDimension.height/s.editorDimension.width*u,_=u/(r*u+u),w=f/(r*f+f),v=_==1/0?u:u*_,b=w==1/0?f:f*w;u>l&&s.editorDimension.height/l*u>s.editorDimension.width&&(_=(f=s.editorDimension.width/s.editorDimension.height*l)/(r*f+f),b=(w=l/(r*l+l))==1/0?l:l*w,v=_==1/0?f:f*_);var y=u*(s.position.left/(s.image_source_dimensions.width+r*s.image_source_dimensions.width))*-1,D=l*(s.position.top/(s.image_source_dimensions.height+r*s.image_source_dimensions.height))*-1;e.drawImage(m,y,D,v,b,0,0,i.width,i.height),console.log(i.toDataURL()),s.$emit("update",i.toDataURL())},t.src=s.image_source},setEditorDimensions:function(){this.resultImageDimension.width>this.resultImageDimension.height?(this.editorDimension.height=this.preffered_diameter,this.editorDimension.width=this.preffered_diameter/this.resultImageDimension.height*this.resultImageDimension.width):(this.editorDimension.width=this.preffered_diameter,this.editorDimension.height=this.preffered_diameter/this.resultImageDimension.width*this.resultImageDimension.height),jQuery(this.$refs["result-image-container"]).css({height:this.editorDimension.height,width:this.editorDimension.width})}},mounted:function(){function i(i){o=!0,n.top=i.clientY,n.left=i.clientX}function e(i){if(o){var e=i.clientX-n.left,t=i.clientY-n.top,a=s.$refs["result-image"];s.setImageResultPosition(jQuery(a).position().left+e,jQuery(a).position().top+t),n.top=i.clientY,n.left=i.clientX}}function t(i){o=!1}var s=this;jQuery(s.$refs["result-image"]);this.setEditorDimensions(),jQuery(this.$refs["file-input"]).change(function(){if(this.files&&this.files[0]){var i=new FileReader;i.onload=function(i){s.image_source=i.target.result,s.calculateImageSourceDimensions()},i.readAsDataURL(this.files[0])}}),jQuery(this.$refs.modal).on("shown.bs.modal",function(i){s.calculateImageSourceDimensions()}),jQuery(this.$refs["editor-container"]).bind("mousedown",i).bind("touchstart",i),jQuery(document).bind("mousemove",e).bind("touchmove",e),jQuery(document).bind("mouseup",t).bind("touchend",t),jQuery(this.$refs["zoom-range"])[0].addEventListener("input",function(){s.zoomImage(this.value)});var o=!1,n={}}},s={install:e},o=null;return"undefined"!=typeof window?o=window.Vue:"undefined"!=typeof global&&(o=global.Vue),o&&o.use(s),i.install=e,i.default=t,i}({});
